{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { PureComponent } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { ViewPropTypes } from \"react-native-web/dist/index\";\nimport PropTypes from 'prop-types';\nimport ViewTransformer from \"../ViewTransformer\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nvar TransformableImage = function (_PureComponent) {\n  _inherits(TransformableImage, _PureComponent);\n\n  var _super = _createSuper(TransformableImage);\n\n  function TransformableImage(props) {\n    var _this;\n\n    _classCallCheck(this, TransformableImage);\n\n    _this = _super.call(this, props);\n    _this.onLayout = _this.onLayout.bind(_assertThisInitialized(_this));\n    _this.onLoad = _this.onLoad.bind(_assertThisInitialized(_this));\n    _this.onLoadStart = _this.onLoadStart.bind(_assertThisInitialized(_this));\n    _this.getViewTransformerInstance = _this.getViewTransformerInstance.bind(_assertThisInitialized(_this));\n    _this.renderError = _this.renderError.bind(_assertThisInitialized(_this));\n    _this.state = {\n      viewWidth: 0,\n      viewHeight: 0,\n      imageLoaded: false,\n      imageDimensions: props.image.dimensions,\n      keyAcumulator: 1\n    };\n    return _this;\n  }\n\n  _createClass(TransformableImage, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      if (!this.state.imageDimensions) {\n        this.getImageSize(this.props.image);\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this._mounted = true;\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      if (!sameImage(this.props.image, nextProps.image)) {\n        this.setState({\n          imageDimensions: nextProps.image.dimensions,\n          keyAcumulator: this.state.keyAcumulator + 1\n        });\n\n        if (!nextProps.image.dimensions) {\n          this.getImageSize(nextProps.image);\n        }\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._mounted = false;\n    }\n  }, {\n    key: \"onLoadStart\",\n    value: function onLoadStart(e) {\n      this.props.onLoadStart && this.props.onLoadStart(e);\n\n      if (this.state.imageLoaded) {\n        this.setState({\n          imageLoaded: false\n        });\n      }\n    }\n  }, {\n    key: \"onLoad\",\n    value: function onLoad(e) {\n      this.props.onLoad && this.props.onLoad(e);\n\n      if (!this.state.imageLoaded) {\n        this.setState({\n          imageLoaded: true\n        });\n      }\n    }\n  }, {\n    key: \"onLayout\",\n    value: function onLayout(e) {\n      var _e$nativeEvent$layout = e.nativeEvent.layout,\n          width = _e$nativeEvent$layout.width,\n          height = _e$nativeEvent$layout.height;\n\n      if (this.state.viewWidth !== width || this.state.viewHeight !== height) {\n        this.setState({\n          viewWidth: width,\n          viewHeight: height\n        });\n      }\n    }\n  }, {\n    key: \"getImageSize\",\n    value: function getImageSize(image) {\n      var _this2 = this;\n\n      if (!image) {\n        return;\n      }\n\n      var source = image.source,\n          dimensions = image.dimensions;\n\n      if (dimensions) {\n        this.setState({\n          imageDimensions: dimensions\n        });\n        return;\n      }\n\n      if (source && source.uri) {\n        Image.getSize(source.uri, function (width, height) {\n          if (width && height) {\n            if (_this2.state.imageDimensions && _this2.state.imageDimensions.width === width && _this2.state.imageDimensions.height === height) {} else {\n              _this2._mounted && _this2.setState({\n                imageDimensions: {\n                  width: width,\n                  height: height\n                }\n              });\n            }\n          }\n        }, function () {\n          _this2._mounted && _this2.setState({\n            error: true\n          });\n        });\n      } else {\n        console.warn('react-native-image-gallery', 'Please provide dimensions of your local images');\n      }\n    }\n  }, {\n    key: \"getViewTransformerInstance\",\n    value: function getViewTransformerInstance() {\n      return this.refs['viewTransformer'];\n    }\n  }, {\n    key: \"renderError\",\n    value: function renderError() {\n      return this.props.errorComponent && this.props.errorComponent() || _jsx(View, {\n        style: {\n          flex: 1,\n          backgroundColor: 'black',\n          alignItems: 'center',\n          justifyContent: 'center'\n        },\n        children: _jsx(Text, {\n          style: {\n            color: 'white',\n            fontSize: 15,\n            fontStyle: 'italic'\n          },\n          children: \"This image cannot be displayed...\"\n        })\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          imageDimensions = _this$state.imageDimensions,\n          viewWidth = _this$state.viewWidth,\n          viewHeight = _this$state.viewHeight,\n          error = _this$state.error,\n          keyAccumulator = _this$state.keyAccumulator,\n          imageLoaded = _this$state.imageLoaded;\n      var _this$props = this.props,\n          style = _this$props.style,\n          image = _this$props.image,\n          imageComponent = _this$props.imageComponent,\n          resizeMode = _this$props.resizeMode,\n          enableTransform = _this$props.enableTransform,\n          enableScale = _this$props.enableScale,\n          enableTranslate = _this$props.enableTranslate,\n          onTransformGestureReleased = _this$props.onTransformGestureReleased,\n          onViewTransformed = _this$props.onViewTransformed;\n      var maxScale = 1;\n      var contentAspectRatio;\n      var width, height;\n\n      if (imageDimensions) {\n        width = imageDimensions.width;\n        height = imageDimensions.height;\n      }\n\n      if (width && height) {\n        contentAspectRatio = width / height;\n\n        if (viewWidth && viewHeight) {\n          maxScale = Math.max(width / viewWidth, height / viewHeight);\n          maxScale = Math.max(1, maxScale);\n        }\n      }\n\n      var imageProps = _objectSpread(_objectSpread({}, this.props), {}, {\n        imageLoaded: imageLoaded,\n        source: image.source,\n        style: [style, {\n          backgroundColor: 'transparent'\n        }],\n        resizeMode: resizeMode,\n        onLoadStart: this.onLoadStart,\n        onLoad: this.onLoad,\n        capInsets: {\n          left: 0.1,\n          top: 0.1,\n          right: 0.1,\n          bottom: 0.1\n        }\n      });\n\n      var content = imageComponent ? imageComponent(imageProps, imageDimensions) : _jsx(Image, _objectSpread({}, imageProps));\n      return _jsx(ViewTransformer, {\n        ref: 'viewTransformer',\n        enableTransform: enableTransform && imageLoaded,\n        enableScale: enableScale,\n        enableTranslate: enableTranslate,\n        enableResistance: true,\n        onTransformGestureReleased: onTransformGestureReleased,\n        onViewTransformed: onViewTransformed,\n        maxScale: maxScale,\n        contentAspectRatio: contentAspectRatio,\n        onLayout: this.onLayout,\n        style: style,\n        children: error ? this.renderError() : content\n      }, 'viewTransformer#' + keyAccumulator);\n    }\n  }]);\n\n  return TransformableImage;\n}(PureComponent);\n\nTransformableImage.propTypes = {\n  image: PropTypes.shape({\n    source: PropTypes.oneOfType([PropTypes.object, PropTypes.number]).isRequired,\n    dimensions: PropTypes.shape({\n      width: PropTypes.number,\n      height: PropTypes.number\n    })\n  }).isRequired,\n  style: ViewPropTypes ? ViewPropTypes.style : View.propTypes.style,\n  onLoad: PropTypes.func,\n  onLoadStart: PropTypes.func,\n  enableTransform: PropTypes.bool,\n  enableScale: PropTypes.bool,\n  enableTranslate: PropTypes.bool,\n  onTransformGestureReleased: PropTypes.func,\n  onViewTransformed: PropTypes.func,\n  imageComponent: PropTypes.func,\n  resizeMode: PropTypes.string,\n  errorComponent: PropTypes.func\n};\nTransformableImage.defaultProps = {\n  enableTransform: true,\n  enableScale: true,\n  enableTranslate: true,\n  imageComponent: undefined,\n  resizeMode: 'contain'\n};\nexport { TransformableImage as default };\n\nfunction sameImage(source, nextSource) {\n  if (source === nextSource) {\n    return true;\n  }\n\n  if (source && nextSource) {\n    if (source.uri && nextSource.uri) {\n      return source.uri === nextSource.uri;\n    }\n  }\n\n  return false;\n}","map":{"version":3,"sources":["C:/Users/takia/OneDrive/Desktop/Data/Projects/mobile_app/mobile_app/Handoff/node_modules/react-native-image-gallery/src/libraries/TransformableImage/index.js"],"names":["React","PureComponent","ViewPropTypes","PropTypes","ViewTransformer","TransformableImage","props","onLayout","bind","onLoad","onLoadStart","getViewTransformerInstance","renderError","state","viewWidth","viewHeight","imageLoaded","imageDimensions","image","dimensions","keyAcumulator","getImageSize","_mounted","nextProps","sameImage","setState","e","nativeEvent","layout","width","height","source","uri","Image","getSize","error","console","warn","refs","errorComponent","flex","backgroundColor","alignItems","justifyContent","color","fontSize","fontStyle","keyAccumulator","style","imageComponent","resizeMode","enableTransform","enableScale","enableTranslate","onTransformGestureReleased","onViewTransformed","maxScale","contentAspectRatio","Math","max","imageProps","capInsets","left","top","right","bottom","content","propTypes","shape","oneOfType","object","number","isRequired","View","func","bool","string","defaultProps","undefined","nextSource"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\nimport { View, Text, Image, ViewPropTypes } from 'react-native';\nimport PropTypes from 'prop-types';\nimport ViewTransformer from '../ViewTransformer';\n\nexport default class TransformableImage extends PureComponent {\n    static propTypes = {\n        image: PropTypes.shape({\n            source: PropTypes.oneOfType([\n                PropTypes.object,\n                PropTypes.number\n            ]).isRequired,\n            dimensions: PropTypes.shape({ width: PropTypes.number, height: PropTypes.number })\n        }).isRequired,\n        style: ViewPropTypes ? ViewPropTypes.style : View.propTypes.style,\n        onLoad: PropTypes.func,\n        onLoadStart: PropTypes.func,\n        enableTransform: PropTypes.bool,\n        enableScale: PropTypes.bool,\n        enableTranslate: PropTypes.bool,\n        onTransformGestureReleased: PropTypes.func,\n        onViewTransformed: PropTypes.func,\n        imageComponent: PropTypes.func,\n        resizeMode: PropTypes.string,\n        errorComponent: PropTypes.func\n    };\n\n    static defaultProps = {\n        enableTransform: true,\n        enableScale: true,\n        enableTranslate: true,\n        imageComponent: undefined,\n        resizeMode: 'contain'\n    };\n\n    constructor (props) {\n        super(props);\n\n        this.onLayout = this.onLayout.bind(this);\n        this.onLoad = this.onLoad.bind(this);\n        this.onLoadStart = this.onLoadStart.bind(this);\n        this.getViewTransformerInstance = this.getViewTransformerInstance.bind(this);\n        this.renderError = this.renderError.bind(this);\n\n        this.state = {\n            viewWidth: 0,\n            viewHeight: 0,\n            imageLoaded: false,\n            imageDimensions: props.image.dimensions,\n            keyAcumulator: 1\n        };\n    }\n\n    componentWillMount () {\n        if (!this.state.imageDimensions) {\n            this.getImageSize(this.props.image);\n        }\n    }\n\n    componentDidMount () {\n        this._mounted = true;\n    }\n\n    componentWillReceiveProps (nextProps) {\n        if (!sameImage(this.props.image, nextProps.image)) {\n            // image source changed, clear last image's imageDimensions info if any\n            this.setState({ imageDimensions: nextProps.image.dimensions, keyAcumulator: this.state.keyAcumulator + 1 });\n            if (!nextProps.image.dimensions) { // if we don't have image dimensions provided in source\n                this.getImageSize(nextProps.image);\n            }\n        }\n    }\n\n    componentWillUnmount () {\n        this._mounted = false;\n    }\n\n    onLoadStart (e) {\n        this.props.onLoadStart && this.props.onLoadStart(e);\n        if (this.state.imageLoaded) {\n            this.setState({ imageLoaded: false });\n        }\n    }\n\n    onLoad (e) {\n        this.props.onLoad && this.props.onLoad(e);\n        if (!this.state.imageLoaded) {\n            this.setState({ imageLoaded: true });\n        }\n    }\n\n    onLayout (e) {\n        let {width, height} = e.nativeEvent.layout;\n        if (this.state.viewWidth !== width || this.state.viewHeight !== height) {\n            this.setState({ viewWidth: width, viewHeight: height });\n        }\n    }\n\n    getImageSize (image) {\n        if (!image) {\n            return;\n        }\n        const { source, dimensions } = image;\n\n        if (dimensions) {\n            this.setState({ imageDimensions: dimensions });\n            return;\n        }\n\n        if (source && source.uri) {\n            Image.getSize(\n                source.uri,\n                (width, height) => {\n                    if (width && height) {\n                        if (this.state.imageDimensions && this.state.imageDimensions.width === width && this.state.imageDimensions.height === height) {\n                            // no need to update state\n                        } else {\n                            this._mounted && this.setState({ imageDimensions: { width, height } });\n                        }\n                    }\n                },\n                () => {\n                    this._mounted && this.setState({ error: true });\n                }\n            );\n        } else {\n            console.warn('react-native-image-gallery', 'Please provide dimensions of your local images');\n        }\n    }\n\n    getViewTransformerInstance () {\n        return this.refs['viewTransformer'];\n    }\n\n    renderError () {\n        return (this.props.errorComponent && this.props.errorComponent()) || (\n            <View style={{ flex: 1, backgroundColor: 'black', alignItems: 'center', justifyContent: 'center' }}>\n                 <Text style={{ color: 'white', fontSize: 15, fontStyle: 'italic' }}>This image cannot be displayed...</Text>\n            </View>\n        );\n    }\n\n    render () {\n        const { imageDimensions, viewWidth, viewHeight, error, keyAccumulator, imageLoaded } = this.state;\n        const { style, image, imageComponent, resizeMode, enableTransform, enableScale, enableTranslate, onTransformGestureReleased, onViewTransformed } = this.props;\n\n        let maxScale = 1;\n        let contentAspectRatio;\n        let width, height; // imageDimensions\n\n        if (imageDimensions) {\n            width = imageDimensions.width;\n            height = imageDimensions.height;\n        }\n\n        if (width && height) {\n            contentAspectRatio = width / height;\n            if (viewWidth && viewHeight) {\n                maxScale = Math.max(width / viewWidth, height / viewHeight);\n                maxScale = Math.max(1, maxScale);\n            }\n        }\n\n        const imageProps = {\n            ...this.props,\n            imageLoaded,\n            source: image.source,\n            style: [style, { backgroundColor: 'transparent' }],\n            resizeMode: resizeMode,\n            onLoadStart: this.onLoadStart,\n            onLoad: this.onLoad,\n            capInsets: { left: 0.1, top: 0.1, right: 0.1, bottom: 0.1 }\n        };\n\n        const content = imageComponent ? imageComponent(imageProps, imageDimensions) : <Image { ...imageProps } />;\n\n        return (\n            <ViewTransformer\n              ref={'viewTransformer'}\n              key={'viewTransformer#' + keyAccumulator} // when image source changes, we should use a different node to avoid reusing previous transform state\n              enableTransform={enableTransform && imageLoaded} // disable transform until image is loaded\n              enableScale={enableScale}\n              enableTranslate={enableTranslate}\n              enableResistance={true}\n              onTransformGestureReleased={onTransformGestureReleased}\n              onViewTransformed={onViewTransformed}\n              maxScale={maxScale}\n              contentAspectRatio={contentAspectRatio}\n              onLayout={this.onLayout}\n              style={style}>\n                { error ? this.renderError() : content }\n            </ViewTransformer>\n        );\n    }\n}\n\nfunction sameImage (source, nextSource) {\n    if (source === nextSource) {\n        return true;\n    }\n    if (source && nextSource) {\n        if (source.uri && nextSource.uri) {\n            return source.uri === nextSource.uri;\n        }\n    }\n    return false;\n}\n"]},"metadata":{},"sourceType":"module"}